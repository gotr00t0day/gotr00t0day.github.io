<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading the Room: Detecting Firewalls Before They Detect You - gotr00t Security Blog</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono:wght@400&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(45deg, #000000, #0a0a0a, #111111);
            color: #ffffff;
            font-family: 'Share Tech Mono', monospace;
            line-height: 1.8;
            min-height: 100vh;
        }

        /* Animated binary background */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle at 1px 1px, rgba(255, 255, 255, 0.15) 1px, transparent 0);
            background-size: 20px 20px;
            animation: binaryFlow 10s linear infinite;
            z-index: -1;
        }

        @keyframes binaryFlow {
            0% { transform: translateY(0); }
            100% { transform: translateY(20px); }
        }

        /* Navigation */
        .nav-header {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid #ffffff;
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 20px rgba(255, 255, 255, 0.3);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0 20px;
        }

        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .nav-link {
            color: #ffffff;
            text-decoration: none;
            padding: 12px 20px;
            border: 1px solid transparent;
            border-radius: 5px;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #ffffff;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .nav-link.active {
            background: rgba(255, 255, 255, 0.2);
            border-color: #ffffff;
            color: #ffffff;
        }

        .nav-link i {
            color: #ffffff;
            width: 16px;
            text-align: center;
        }

        /* Main content */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 20px;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            min-height: 100vh;
        }

        .terminal-prompt {
            color: #00ff00;
            font-family: 'Share Tech Mono', monospace;
            font-size: 1.2em;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #00ff00;
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.8em;
            font-weight: 900;
            text-align: center;
            margin-bottom: 20px;
            color: #ffffff;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            letter-spacing: 3px;
        }

        h2 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2em;
            font-weight: 700;
            margin: 30px 0 15px 0;
            color: #ffffff;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
            letter-spacing: 2px;
        }

        h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5em;
            font-weight: 400;
            margin: 25px 0 10px 0;
            color: #ffffff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
            letter-spacing: 1px;
        }

        p {
            margin-bottom: 20px;
            color: #ffffff;
            font-size: 1.1em;
        }

        strong {
            color: #ffffff;
            font-weight: bold;
        }

        em {
            color: #cccccc;
            font-style: italic;
        }

        a {
            color: #00ff00;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        a:hover {
            color: #ffffff;
            text-shadow: 0 0 10px #00ff00;
        }

        /* Code/command styling */
        code {
            background: rgba(255, 255, 255, 0.1);
            color: #00ff00;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Share Tech Mono', monospace;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Pre-formatted code blocks */
        pre {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid #ffffff;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'Share Tech Mono', monospace;
            line-height: 1.4;
        }

        pre code {
            background: none;
            border: none;
            padding: 0;
            color: #00ff00;
        }

        /* Highlighted text */
        mark {
            background: rgba(255, 255, 255, 0.2);
            color: #00ff00;
            padding: 2px 6px;
            border-radius: 3px;
        }

        /* Lists */
        ol, ul {
            margin: 20px 0;
            padding-left: 30px;
        }

        ol li, ul li {
            margin-bottom: 10px;
            color: #ffffff;
            font-size: 1.1em;
        }

        /* Conclusion section */
        .conclusion {
            border-top: 2px solid #ffffff;
            margin-top: 40px;
            padding-top: 30px;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .nav-links {
                gap: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }

            .nav-link {
                padding: 10px 15px;
                font-size: 0.9em;
            }

            h1 {
                font-size: 2em;
            }

            h2 {
                font-size: 1.6em;
            }

            .container {
                padding: 20px 15px;
            }
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav class="nav-header">
        <div class="nav-container">
            <ul class="nav-links">
                <li><a href="../index.html" class="nav-link"><i class="fas fa-home"></i>Home</a></li>
                <li><a href="../poc.html" class="nav-link"><i class="fas fa-bug"></i>PoC</a></li>
                <li><a href="../projects.html" class="nav-link"><i class="fas fa-code"></i>Projects</a></li>
                <li><a href="../guides.html" class="nav-link"><i class="fas fa-book"></i>Guides</a></li>
                <li><a href="../blog.html" class="nav-link active"><i class="fas fa-pen-nib"></i>Blog</a></li>
                <li><a href="../contact.html" class="nav-link"><i class="fas fa-envelope"></i>Contact</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="terminal-prompt">gotr00t@firewall:~$</div>
        
        <h1>Reading the Room: Detecting Firewalls Before They Detect You</h1>

        <h2>Firewalls on Linux</h2>

        <p>Whats a firewall on Linux? A firewall installed on a Linux system acts as a traffic filtering system that controls which network activities ares allowed. It enforces security policy by inspecting packet headers and deciding to accept, drop or reject them.</p>

        <p><strong><em>Why detect firewalls?</em></strong></p>

        <p>Detecting firewalls during post exploitation its about mapping the control plane of the network, it allows you to understand what security boundaries exist and how traffic is filtered.</p>

        <h2>Defining the Attack Surface</h2>

        <p>A firewall can determine which ports are reachable, which protocols are allowed and what hosts and services are exposed. Without detecting this attack surface you may wast time attacking blocked ports and miss reachable services on alternate ports.</p>

        <p>A lot of different firewall policies leak information through packet behavior. These behaviors allow you to identify if there's a firewall blocking your requests.</p>

        <h2>Main Linux Firewalls</h2>

        <h3>1. Iptables</h3>

        <p>Low-level CLI to configure Netfilter using tables and chains.</p>

        <pre><code>iptables -A INPUT -p tcp --dport 22 -j ACCEPT
iptables -A INPUT -j DROP</code></pre>

        <p>Lets look at these 2 commands, at first glance they're short, but together they implement a strong default and deny firewall policy.</p>

        <p><mark>First rule — allow SSH</mark>:</p>

        <p><code>iptables -A INPUT -p tcp --dport 22 -j ACCEPT</code></p>

        <p><mark>What each part means</mark>:</p>

        <ol>
            <li>-A INPUT: append rule to the INPUT chain (traffic coming into this machine)</li>
            <li>-p tcp: match TCP packets only</li>
            <li>--dport 22: match destination port 22</li>
            <li>-j ACCEPT: allow the packet</li>
        </ol>

        <p><mark>Second rule — drop everything else</mark>:</p>

        <p><code>iptables -A INPUT -j DROP</code></p>

        <p><mark>What it means</mark>:</p>

        <ol>
            <li>-A INPUT: still filtering inbound traffic</li>
            <li>-j DROP: silently discard packets</li>
        </ol>

        <h3>2. Nftables</h3>

        <p>Successor to iptables. Unified, faster, simpler rule engine.</p>

        <p><code>nft add rule inet filter input tcp dport 22 accept</code></p>

        <p>This command allows incoming SSH traffic.</p>

        <h3>3. Firewalld</h3>

        <p>Higher-level service that manages nftables/iptables underneath.</p>

        <pre><code>firewall-cmd --add-service=ssh
firewall-cmd --permanent --add-service=http</code></pre>

        <p>These 2 commands allows SSH now and also allows HTTP permanently.</p>

        <h3>4. UFW</h3>

        <p>Simple frontend to iptables/nftables, beginner-friendly.</p>

        <pre><code>ufw allow 22
ufw enable</code></pre>

        <p>These 2 commands will allow SSH access and turn the firewall on.</p>

        <h2>Automating the Process of Detecting Firewalls</h2>

        <p>I wrote a simple but effective Bash script that detects which firewalls are installed and running on a Linux system. This is the first time I'm sharing the code publicly.</p>

        <p><strong>fw_detect.sh:</strong></p>

        <pre><code>#!/bin/bash
# fw_detect.sh — Quick Linux firewall detection
# by c0d3Ninja

RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
CYAN='\033[0;36m'
BOLD='\033[1m'
RESET='\033[0m'

echo -e "${BOLD}${CYAN}[*] Firewall Detection${RESET}"
echo -e "─────────────────────────────────"
found=0

# iptables
if command -v iptables &amp;&gt;/dev/null; then
    rules=$(iptables -L -n 2&gt;/dev/null | grep -cve '^Chain\|^target\|^$' 2&gt;/dev/null)
    if [ "$rules" -gt 0 ] 2&gt;/dev/null; then
        echo -e "${GREEN}[+] iptables${RESET} — ACTIVE ($rules rules)"
        found=1
    else
        echo -e "${YELLOW}[~] iptables${RESET} — installed, no rules"
    fi
fi

# nftables
if command -v nft &amp;&gt;/dev/null; then
    tables=$(nft list tables 2&gt;/dev/null | wc -l)
    if [ "$tables" -gt 0 ] 2&gt;/dev/null; then
        echo -e "${GREEN}[+] nftables${RESET} — ACTIVE ($tables tables)"
        found=1
    else
        echo -e "${YELLOW}[~] nftables${RESET} — installed, no tables"
    fi
fi

# ufw
if command -v ufw &amp;&gt;/dev/null; then
    status=$(ufw status 2&gt;/dev/null | head -1)
    if echo "$status" | grep -qi "active"; then
        echo -e "${GREEN}[+] ufw${RESET} — ACTIVE"
        found=1
    else
        echo -e "${YELLOW}[~] ufw${RESET} — installed, inactive"
    fi
fi

# firewalld
if command -v firewall-cmd &amp;&gt;/dev/null; then
    if firewall-cmd --state 2&gt;/dev/null | grep -qi "running"; then
        zone=$(firewall-cmd --get-default-zone 2&gt;/dev/null)
        echo -e "${GREEN}[+] firewalld${RESET} — ACTIVE (zone: $zone)"
        found=1
    else
        echo -e "${YELLOW}[~] firewalld${RESET} — installed, not running"
    fi
fi

# CSF (ConfigServer Firewall)
if command -v csf &amp;&gt;/dev/null; then
    if csf -l &amp;&gt;/dev/null; then
        echo -e "${GREEN}[+] CSF${RESET} — ACTIVE"
        found=1
    else
        echo -e "${YELLOW}[~] CSF${RESET} — installed"
    fi
fi

# APF (Advanced Policy Firewall)
if command -v apf &amp;&gt;/dev/null; then
    echo -e "${GREEN}[+] APF${RESET} — installed"
    found=1
fi

# Shorewall
if command -v shorewall &amp;&gt;/dev/null; then
    if shorewall status 2&gt;/dev/null | grep -qi "running"; then
        echo -e "${GREEN}[+] Shorewall${RESET} — ACTIVE"
        found=1
    else
        echo -e "${YELLOW}[~] Shorewall${RESET} — installed, not running"
    fi
fi

# fail2ban
if command -v fail2ban-client &amp;&gt;/dev/null; then
    jails=$(fail2ban-client status 2&gt;/dev/null | grep "Number of jail" | awk '{print $NF}')
    if [ -n "$jails" ] &amp;&amp; [ "$jails" -gt 0 ] 2&gt;/dev/null; then
        echo -e "${GREEN}[+] fail2ban${RESET} — ACTIVE ($jails jails)"
        found=1
    else
        echo -e "${YELLOW}[~] fail2ban${RESET} — installed"
    fi
fi

# SELinux
if command -v getenforce &amp;&gt;/dev/null; then
    mode=$(getenforce 2&gt;/dev/null)
    if [ "$mode" = "Enforcing" ]; then
        echo -e "${GREEN}[+] SELinux${RESET} — ENFORCING"
        found=1
    elif [ "$mode" = "Permissive" ]; then
        echo -e "${YELLOW}[~] SELinux${RESET} — Permissive (logging only)"
    else
        echo -e "${YELLOW}[~] SELinux${RESET} — Disabled"
    fi
fi

# AppArmor
if command -v aa-status &amp;&gt;/dev/null; then
    profiles=$(aa-status 2&gt;/dev/null | grep "profiles are in enforce" | awk '{print $1}')
    if [ -n "$profiles" ] &amp;&amp; [ "$profiles" -gt 0 ] 2&gt;/dev/null; then
        echo -e "${GREEN}[+] AppArmor${RESET} — ACTIVE ($profiles enforced profiles)"
        found=1
    else
        echo -e "${YELLOW}[~] AppArmor${RESET} — installed"
    fi
fi

# AWS Security Groups (check if running on EC2)
if curl -s --connect-timeout 1 http://169.254.169.254/latest/meta-data/ &amp;&gt;/dev/null; then
    echo -e "${CYAN}[*] AWS EC2${RESET} — Security Groups likely in place"
fi

# Check for related systemd services
echo ""
echo -e "${BOLD}${CYAN}[*] Firewall Services${RESET}"
echo -e "─────────────────────────────────"
for svc in iptables nftables ufw firewalld csf fail2ban apparmor; do
    status=$(systemctl is-active $svc 2&gt;/dev/null)
    if [ "$status" = "active" ]; then
        echo -e "${GREEN}[+] $svc.service${RESET} — running"
    elif systemctl list-unit-files 2&gt;/dev/null | grep -q "^${svc}"; then
        echo -e "${YELLOW}[~] $svc.service${RESET} — installed, $status"
    fi
done

# Open ports as seen internally
echo ""
echo -e "${BOLD}${CYAN}[*] Listening Ports${RESET}"
echo -e "─────────────────────────────────"
if command -v ss &amp;&gt;/dev/null; then
    ss -tlnp 2&gt;/dev/null | tail -n +2
elif command -v netstat &amp;&gt;/dev/null; then
    netstat -tlnp 2&gt;/dev/null | tail -n +2
fi

echo ""
if [ "$found" -eq 0 ]; then
    echo -e "${RED}${BOLD}[!] No active firewall detected${RESET}"
else
    echo -e "${GREEN}${BOLD}[+] Firewall(s) detected${RESET}"
fi</code></pre>

        <div class="conclusion">
            <p>Once you identify which firewall services are installed on the compromised system, you can adjust rules to allow specific ports and services or otherwise modify the firewall configuration to remove restrictions and continue further testing.</p>

            <h1>HACKING FROM THE SHADOWS!</h1>
        </div>

    </div>

</body>
</html>
